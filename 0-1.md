# 0-1 话说你想做一个插件……

## 谈谈服务器

某个闲暇的午后，你坐在电脑前，一边念叨着什么“MC，启动”，一边打开你的启动器，像往常一样平平无奇枯燥乏味地打开了你的 Minecraft。然后，你点击“多人游戏”，找到了那个你每天都玩的**服务器**，双击**连接**，然后就进入了服务器上的世界……

等一下，这事有点不一般！为什么一个**服务器**能够让几个玩家出现在一个世界里面呢？**服务器**到底是做什么的呢？

当你按下 W 的时候，你告诉 Minecraft，“让我的角色前进一步”。就在这个瞬间，发生了这么几件事情：

- 你电脑上的 Minecraft 通过一个建立好的**网络连接**，向服务器发了一条**消息**：“名为 skjsjhb 的玩家想要前进一步”。

- 服务器在它自己那里默默**计算**着玩家前进一步会发生什么，“哦，这前面有个苦力怕，玩家往前面走了一步，啊哈，它该开始爆炸了！”

- 服务器完成这些**计算**后，再给每个玩家**广播**一条**消息**：“位于 XXX 的苦力怕要爆炸了，请让它开始发光变大！”

- 各个玩家收到这些**消息**后，他们电脑上的 Minecraft 做出反应，开始让苦力怕变大并且闪烁。

看见了吗？**多人游戏**并不是什么魔法，是有一台**服务器**通过**网络**在各个玩家的游戏之间不停地**跑腿传话**，告诉每一名玩家这里发生了什么什么，那里发生了什么什么……

每个玩家电脑上的游戏被称作**客户端（Client）**，负责传话的这个服务器称作多人游戏的**服务器（Server）**，这个传话的过程，叫做**同步（Sync）**，服务器计算苦力怕是不是该爆炸了，玩家走到哪了，这些**服务器内部**的工作，被称为**处理（Process）**。

## 插件能做什么

首先要明确的一点：**插件是运行在服务器上的**。

<span style="font-size:xxx-large">插件是运行在服务器上的。</span>

*（没办法，不把字放大点有些人都不看的）*

这也就是说，我们可以干预服务器的**处理**过程，至于怎么做到这一点我们后面再讲，但现在就请先记住，插件的作用是**改变服务器的行为**。

你不能通过写一个插件让用户的电脑把硬盘格式化了，你也不能让用户的电脑给你截屏然后发上来，因为你**不能干预客户端**，模组可以做到，但是插件不行。

**我们能做的只有修改服务器。**

> **到底怎么回事？**
> 
> 玩过纯净服的玩家都知道，纯净服不需要安装他们指定的客户端，只需要一个原版的 Minecraft，就可以享受服务器中的内容。但是，这些服务器很无聊吗？只能玩 Mojang 提供的那少得可怜的内容吗？什么**设置家**，什么**圈地**，什么 **MMO 技能**，都是哪来的呢？其实这些，都是插件提供的。
> 
> 插件可以在**只修改服务器的前提下，间接地影响客户端的行为**，是不是很神奇？请接着看下面的内容。

如果我们只能修改服务器，对客户端**什么也做不了**的话，那修改服务器有什么用呢？客户端该干啥还是干啥，理都不理我们一下，哎呀，好没意思。

插件就妙在，它可以通过**利用客户端的机制**，通过修改服务器来**间接影响客户端**。

下面我们看一个例子。

## Saki 和她的钻石镐

Saki 今天出门采矿收获颇丰，她决定要用采来的钻石打一把钻石镐。为此，她把钻石和木棍放到合成栏里面……

这个时候发生了什么呢？

- Saki 的客户端告诉服务器：“玩家 Saki 把钻石和木棍摆成了这个样子，我该做什么？在线等，急急急！”

- 服务器收到这个消息，它默默**计算**：“哦，这个配方，对应的就是钻石镐的配方嘛，那，就让客户端显示一个钻石镐给玩家好咯。”

- 服务器把它的结论**告诉客户端**：“在工作台上显示钻石镐。”

- Saki 的客户端收到消息，它把钻石镐显示在工作台上，然后 Saki 左键轻轻一点，就拿到了她的下一把采矿工具。

Saki 的这一天过得挺完美，但很不凑巧，我是个坏蛋，我不想让她就这么拿到钻石镐了，**我偷偷地跑到了游戏服务器那边，然后开始干坏事**。

我在服务器上放了一个插件，它的作用是：**只要有玩家把钻石和木棍摆成这个形状，就在她身边刷新 100 只苦力怕。**

现在我们重新看一下这个过程：

- Saki 的客户端告诉服务器：“玩家 Saki 把钻石和木棍摆成了这个样子，我该做什么？在线等，急急急！”

- 服务器收到这个消息，它默默**计算**：“哦，这个配方，对应的就是钻石镐的配方嘛，那，就让客户端显示一个钻……诶，等等！**只要有玩家把钻石和木棍摆成这个形状，就在她身边刷新 100 只苦力怕**……？哦，我明白了，那就在玩家 Saki 身边刷新 100 只苦力怕嘛！”

- 服务器把它的结论**告诉客户端**：“在玩家附近显示 100 只苦力怕。”

- Saki 的客户端收到消息，然后在 Saki 身边刷新了 100 只苦力怕，Saki 被炸飞了。

这一天，Saki 晚上没睡好。她怎么也想不明白，为什么明明给出了正确的配方，结果却完全不一样。

---

当然我可不是坏人，从上面这个例子里，我们能看出插件能做的事情。

插件能让**服务器对于客户端的消息有完全不同的反应**，使得客户端做出与原版游戏不一样的行为。

而我们要做的，只是告诉服务器：

**只要有玩家把钻石和木棍摆成这个形状，就在她身边刷新 100 只苦力怕。**

请把这个作为我们以后开发插件的基本思路。

*有关插件的局限和本质工作原理的探讨还会在后面的章节深入讲解，届时我会谈谈自己的思考，不过就现在而言这些内容已经够你理解一会儿了。*
